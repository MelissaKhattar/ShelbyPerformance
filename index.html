<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Brand Performance Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #1A3661;
            color: #333;
        }
        .container {
            max-width: 1200px;
            margin: 2rem auto;
            padding: 1.5rem;
            background-color: #ffffff;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        }
        .card {
            background-color: #ffffff;
            border-radius: 10px;
            padding: 1.5rem;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
            margin-bottom: 1.5rem;
        }
        .header {
            background-color: #4f46e5;
            color: white;
            padding: 1.5rem;
            border-radius: 12px 12px 0 0;
            text-align: center;
            margin-top: -1.5rem; /* Adjust to align with container top */
            margin-left: -1.5rem; /* Adjust to align with container left */
            margin-right: -1.5rem; /* Adjust to align with container right */
            margin-bottom: 1.5rem;
        }
        .table-container {
            overflow-x: auto;
            border-radius: 8px;
            border: 1px solid #e2e8f0;
        }
        table {
            width: 100%;
            border-collapse: collapse;
        }
        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #e2e8f0;
        }
        th {
            background-color: #f8fafc;
            font-weight: 600;
            color: #475569;
            white-space: nowrap; /* Prevent wrapping for headers */
        }
        td {
            background-color: #ffffff;
        }
        tr:hover td {
            background-color: #f0f4f8;
        }
        .sentiment-positive { color: #10b981; font-weight: 600; } /* Green */
        .sentiment-negative { color: #ef4444; font-weight: 600; } /* Red */
        .sentiment-neutral { color: #fbbf24; font-weight: 600; } /* Amber */
        .metric-value {
            font-size: 2.25rem; /* text-4xl */
            font-weight: 700; /* font-bold */
            color: #4f46e5; /* indigo-600 */
        }
        .metric-label {
            font-size: 0.875rem; /* text-sm */
            color: #64748b; /* slate-500 */
            margin-top: 0.5rem;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header rounded-t-xl">
            <h1 class="text-3xl font-bold mb-2">Brand Performance Dashboard</h1>
            <p class="text-lg">Shelby's Shawarma & Abbas Smoothies (Jan - Jun 2025)</p>
        </div>

        <!-- Overall Performance Metrics -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
            <div class="card flex flex-col items-center justify-center p-6 rounded-xl">
                <div class="metric-value">4.6</div>
                <div class="metric-label">Average Rating (After)</div>
            </div>
            <div class="card flex flex-col items-center justify-center p-6 rounded-xl">
                <div class="metric-value">20,588</div>
                <div class="metric-label">Total New Reviews</div>
            </div>
            <div class="card flex flex-col items-center justify-center p-6 rounded-xl">
                <div class="metric-value">12</div>
                <div class="metric-label">Locations with Rating Increase</div>
            </div>
            <div class="card flex flex-col items-center justify-center p-6 rounded-xl">
                <div class="metric-value">6</div>
                <div class="metric-label">Locations with Rating Decrease</div>
            </div>
            <div class="card flex flex-col items-center justify-center p-6 rounded-xl">
                <div class="metric-value">22</div>
                <div class="metric-label">Locations with No Rating Change</div>
            </div>
            <div class="card flex flex-col items-center justify-center p-6 rounded-xl">
                <div class="metric-value">51.2%</div>
                <div class="metric-label">Locations with No Rating Change (%)</div>
            </div>
        </div>

        <!-- Key Highlights / Lowlights -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
            <div class="card p-6 rounded-xl">
                <h2 class="text-xl font-semibold text-gray-800 mb-4">Key Performance Highlights</h2>
                <ul class="list-disc list-inside text-gray-700 space-y-2">
                    <li><span class="font-medium">Biggest Rating Increase:</span> <span class="sentiment-positive">Shelby's Shawarma-Richmond Hill (+0.3)</span></li>
                    <li><span class="font-medium">Most New Reviews:</span> <span class="text-blue-600">Shelby's Shawarma-McLeod (1691)</span></li>
                    <li><span class="font-medium">Top Positive Category (Service):</span> <span class="sentiment-positive">87.91% Positive</span></li>
                    <li><span class="font-medium">Top Positive Secondary (Service Friendliness):</span> <span class="sentiment-positive">1699 Positive Mentions</span></li>
                </ul>
            </div>
            <div class="card p-6 rounded-xl">
                <h2 class="text-xl font-semibold text-gray-800 mb-4">Key Performance Lowlights</h2>
                <ul class="list-disc list-inside text-gray-700 space-y-2">
                    <li><span class="font-medium">Biggest Rating Drop:</span> <span class="sentiment-negative">Shelby's Shawarma-Nepean (-0.3)</span></li>
                    <li><span class="font-medium">Most Negative Category (Price):</span> <span class="sentiment-negative">86.40% Negative</span></li>
                    <li><span class="font-medium">Most Negative Secondary (Delivery Accuracy):</span> <span class="sentiment-negative">260 Negative Mentions</span></li>
                    <li><span class="font-medium">Critical Trend:</span> <span class="sentiment-negative">Delivery Accuracy consistently negative (-66 to -100)</span></li>
                </ul>
            </div>
        </div>

        <!-- Primary Categories Sentiment -->
        <div class="card p-6 rounded-xl mb-8">
            <h2 class="text-xl font-semibold text-gray-800 mb-4">Primary Categories Sentiment (June 2025)</h2>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Category</th>
                            <th>Positive %</th>
                            <th>Negative %</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Food</td>
                            <td class="sentiment-positive">82.45%</td>
                            <td class="sentiment-negative">17.55%</td>
                        </tr>
                        <tr>
                            <td>Service</td>
                            <td class="sentiment-positive">87.91%</td>
                            <td class="sentiment-negative">12.09%</td>
                        </tr>
                        <tr>
                            <td>Price</td>
                            <td class="sentiment-negative">13.60%</td>
                            <td class="sentiment-negative">86.40%</td>
                        </tr>
                        <tr>
                            <td>Atmosphere</td>
                            <td class="sentiment-positive">86.95%</td>
                            <td class="sentiment-negative">13.05%</td>
                        </tr>
                        <tr>
                            <td>Delivery</td>
                            <td class="sentiment-neutral">69.66%</td>
                            <td class="sentiment-negative">30.34%</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Response Rate Table -->
        <div class="card p-6 rounded-xl mb-8">
            <h2 class="text-xl font-semibold text-gray-800 mb-4">Review Response Rates & Times (June 2025)</h2>
            <div class="table-container">
                <table id="responseRateTable">
                    <thead>
                        <tr>
                            <th>Location</th>
                            <th>Rating</th>
                            <th>Total Reviews</th>
                            <th>Total Responses</th>
                            <th>Response Rate (%)</th>
                            <th>Avg. Response Time (days)</th>
                            <th>Positive Response Rate (%)</th>
                            <th>Negative Response Rate (%)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Data will be populated by JavaScript -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Trend Chart Data (Simplified Display) -->
        <div class="card p-6 rounded-xl">
            <h2 class="text-xl font-semibold text-gray-800 mb-4">Sentiment Trend Chart Data (June - July 2025)</h2>
            <p class="text-gray-600 mb-4">This table displays the weekly **Sentiment Index** for each category, ranging from -100 (most negative) to 100 (most positive).</p>
            <div class="table-container">
                <table id="trendChartTable">
                    <thead>
                        <tr>
                            <th>Category</th>
                            <th>01-07 Jun</th>
                            <th>08-14 Jun</th>
                            <th>15-21 Jun</th>
                            <th>22-28 Jun</th>
                            <th>29 Jun-05 Jul</th>
                            <th>06-12 Jul</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Data will be populated by JavaScript -->
                    </tbody>
                </table>
            </div>
        </div>

    </div>

    <script>
        // Data from Part 1, 2, 3, 4, 5
        const locationPerformanceData = [
            { "Location": "Downtown", "Platform": "Google", "Before Date": "January 2025", "Before Rating": 4.4, "Before Reviews": 4331, "After Date": "June 28 2025", "After Rating": 4.5, "After Reviews": 4915, "Feedback used": "yes", "Rating Change": 0.1, "Review Count Change": 584, "Analysis": "Strong Improvement in Rating" },
            { "Location": "Oakville", "Platform": "Google", "Before Date": "January 2025", "Before Rating": 4.4, "Before Reviews": 3596, "After Date": "June 28 2025", "After Rating": 4.5, "After Reviews": 4266, "Feedback used": "yes", "Rating Change": 0.1, "Review Count Change": 670, "Analysis": "Strong Improvement in Rating" },
            { "Location": "Upper James", "Platform": "Google", "Before Date": "January 2025", "Before Rating": 4.4, "Before Reviews": 1496, "After Date": "June 28 2025", "After Rating": 4.4, "After Reviews": 1720, "Feedback used": "yes", "Rating Change": 0, "Review Count Change": 224, "Analysis": "More Reviews, Same Rating" },
            { "Location": "White Oaks", "Platform": "Google", "Before Date": "January 2025", "Before Rating": 4.3, "Before Reviews": 1477, "After Date": "June 28 2025", "After Rating": 4.3, "After Reviews": 1564, "Feedback used": "yes", "Rating Change": 0, "Review Count Change": 87, "Analysis": "More Reviews, Same Rating" },
            { "Location": "Talbot Village", "Platform": "Google", "Before Date": "January 2025", "Before Rating": 4.2, "Before Reviews": 408, "After Date": "June 28 2025", "After Rating": 4.3, "After Reviews": 480, "Feedback used": "No", "Rating Change": 0.1, "Review Count Change": 72, "Analysis": "Strong Improvement in Rating" },
            { "Location": "MasonVille", "Platform": "Google", "Before Date": "January 2025", "Before Rating": 4.4, "Before Reviews": 888, "After Date": "June 28 2025", "After Rating": 4.4, "After Reviews": 950, "Feedback used": "Yes", "Rating Change": 0, "Review Count Change": 62, "Analysis": "More Reviews, Same Rating" },
            { "Location": "Highbury", "Platform": "Google", "Before Date": "January 2025", "Before Rating": 4.4, "Before Reviews": 1285, "After Date": "June 28 2025", "After Rating": 4.6, "After Reviews": 1919, "Feedback used": "Yes", "Rating Change": 0.2, "Review Count Change": 634, "Analysis": "Strong Improvement in Rating" },
            { "Location": "Oakridge", "Platform": "Google", "Before Date": "January 2025", "Before Rating": 4.3, "Before Reviews": 983, "After Date": "June 28 2025", "After Rating": 4.4, "After Reviews": 1245, "Feedback used": "Yes", "Rating Change": 0.1, "Review Count Change": 262, "Analysis": "Strong Improvement in Rating" },
            { "Location": "West Five", "Platform": "Google", "Before Date": "January 2025", "Before Rating": 4.1, "Before Reviews": 141, "After Date": "June 28 2025", "After Rating": 4.1, "After Reviews": 175, "Feedback used": "Yes", "Rating Change": 0, "Review Count Change": 34, "Analysis": "Strong Improvement in Rating" },
            { "Location": "St Thomas", "Platform": "Google", "Before Date": "January 2025", "Before Rating": 4.4, "Before Reviews": 489, "After Date": "June 28 2025", "After Rating": 4.4, "After Reviews": 516, "Feedback used": "Yes", "Rating Change": 0, "Review Count Change": 27, "Analysis": "More Reviews, Same Rating" },
            { "Location": "Strathroy", "Platform": "Google", "Before Date": "January 2025", "Before Rating": 4.2, "Before Reviews": 163, "After Date": "June 28 2025", "After Rating": 4.2, "After Reviews": 163, "Feedback used": "No", "Rating Change": 0, "Review Count Change": 0, "Analysis": "No Change" },
            { "Location": "Hespeler", "Platform": "Google", "Before Date": "January 2025", "Before Rating": 4.7, "Before Reviews": 1236, "After Date": "June 28 2025", "After Rating": 4.8, "After Reviews": 2186, "Feedback used": "Yes", "Rating Change": 0.1, "Review Count Change": 950, "Analysis": "Strong Improvement in Rating" },
            { "Location": "Windsor", "Platform": "Google", "Before Date": "January 2025", "Before Rating": 4.3, "Before Reviews": 1524, "After Date": "June 28 2025", "After Rating": 4.3, "After Reviews": 1767, "Feedback used": "Yes", "Rating Change": 0, "Review Count Change": 243, "Analysis": "More Reviews, Same Rating" },
            { "Location": "Rexdale", "Platform": "Google", "Before Date": "January 2025", "Before Rating": 4.5, "Before Reviews": 3478, "After Date": "June 28 2025", "After Rating": 4.5, "After Reviews": 4059, "Feedback used": "Yes", "Rating Change": 0, "Review Count Change": 581, "Analysis": "More Reviews, Same Rating" },
            { "Location": "Queen & Spadina", "Platform": "Google", "Before Date": "January 2025", "Before Rating": 4.7, "Before Reviews": 2715, "After Date": "June 28 2025", "After Rating": 4.7, "After Reviews": 3070, "Feedback used": "Yes", "Rating Change": 0, "Review Count Change": 355, "Analysis": "More Reviews, Same Rating" },
            { "Location": "Bloor & Bathurst", "Platform": "Google", "Before Date": "January 2025", "Before Rating": 4.8, "Before Reviews": 1459, "After Date": "June 28 2025", "After Rating": 4.7, "After Reviews": 2033, "Feedback used": "Yes", "Rating Change": -0.1, "Review Count Change": 574, "Analysis": "Strong Drop in Rating" },
            { "Location": "Bloor West Village", "Platform": "Google", "Before Date": "January 2025", "Before Rating": 4.7, "Before Reviews": 998, "After Date": "June 28 2025", "After Rating": 4.7, "After Reviews": 1308, "Feedback used": "Yes", "Rating Change": 0, "Review Count Change": 310, "Analysis": "More Reviews, Same Rating" },
            { "Location": "Montpelier", "Platform": "Google", "Before Date": "January 2025", "Before Rating": 4.5, "Before Reviews": 955, "After Date": "June 28 2025", "After Rating": 4.5, "After Reviews": 1378, "Feedback used": "Yes", "Rating Change": 0, "Review Count Change": 423, "Analysis": "More Reviews, Same Rating" },
            { "Location": "Hwy #7", "Platform": "Google", "Before Date": "January 2025", "Before Rating": 4.7, "Before Reviews": 810, "After Date": "June 28 2025", "After Rating": 4.7, "After Reviews": 1507, "Feedback used": "Yes", "Rating Change": 0, "Review Count Change": 697, "Analysis": "More Reviews, Same Rating" },
            { "Location Title": "St.Catharines", "Location ID": "St.Catharines", "Rating": 4.68, "Reviews": 523, "Positive": 10, "Neutral": 30, "Negative": 563, "Total Reviews": 563, "Responses Positive": 315, "Responses Neutral": 59, "Responses Negative": 10, "Responses Total": 23, "Response Rate Positive": 56, "Response Rate Neutral": 1, "Response Rate Negative": 3, "Response Rate Total": 1 },
            { "Location Title": "Shelby's Shawarma", "Location ID": "McLeod", "Rating": 4.63, "Reviews": 672, "Positive": 23, "Neutral": 44, "Negative": 739, "Total Reviews": 739, "Responses Positive": 546, "Responses Neutral": 76, "Responses Negative": 39, "Responses Total": 59, "Response Rate Positive": 74, "Response Rate Neutral": 1, "Response Rate Negative": 2, "Response Rate Total": 1 },
            { "Location Title": "Shelby's Shawarma", "Location ID": "Clearbrook", "Rating": 4.71, "Reviews": 362, "Positive": 12, "Neutral": 17, "Negative": 391, "Total Reviews": 391, "Responses Positive": 139, "Responses Neutral": 37, "Responses Negative": 8, "Responses Total": 18, "Response Rate Positive": 36, "Response Rate Neutral": 1, "Response Rate Negative": 1, "Response Rate Total": 1 },
            { "Location Title": "Shelby's Shawarma", "Location ID": "Sarnia", "Rating": 4.62, "Reviews": 148, "Positive": 6, "Neutral": 8, "Negative": 162, "Total Reviews": 162, "Responses Positive": 54, "Responses Neutral": 31, "Responses Negative": 33, "Responses Total": 75, "Response Rate Positive": 33, "Response Rate Neutral": 2, "Response Rate Negative": 1, "Response Rate Total": 2 },
            { "Location Title": "Shelby's Shawarma", "Location ID": "Burlington", "Rating": 4.49, "Reviews": 212, "Positive": 8, "Neutral": 28, "Negative": 248, "Total Reviews": 248, "Responses Positive": 65, "Responses Neutral": 28, "Responses Negative": 13, "Responses Total": 14, "Response Rate Positive": 26, "Response Rate Neutral": 1, "Response Rate Negative": 2, "Response Rate Total": 1 },
            { "Location Title": "Shelby's Shawarma", "Location ID": "Head Office", "Rating": 0, "Reviews": 0, "Positive": 0, "Neutral": 0, "Negative": 0, "Total Reviews": 0, "Responses Positive": 0, "Responses Neutral": 0, "Responses Negative": 0, "Responses Total": 0, "Response Rate Positive": 0, "Response Rate Neutral": 0, "Response Rate Negative": 0, "Response Rate Total": 0 },
            { "Location Title": "Shelby's Shawarma", "Location ID": "Lawrence", "Rating": 4.48, "Reviews": 423, "Positive": 19, "Neutral": 44, "Negative": 486, "Total Reviews": 486, "Responses Positive": 408, "Responses Neutral": 86, "Responses Negative": 68, "Responses Total": 75, "Response Rate Positive": 84, "Response Rate Neutral": 2, "Response Rate Negative": 2, "Response Rate Total": 2 },
            { "Location Title": "Shelby's Shawarma", "Location ID": "King & John", "Rating": 4.18, "Reviews": 208, "Positive": 17, "Neutral": 44, "Negative": 269, "Total Reviews": 269, "Responses Positive": 64, "Responses Neutral": 26, "Responses Negative": 24, "Responses Total": 11, "Response Rate Positive": 24, "Response Rate Neutral": 1, "Response Rate Negative": 2, "Response Rate Total": 0 },
            { "Location Title": "Shelby's Shawarma", "Location ID": "McMaster", "Rating": 4.59, "Reviews": 172, "Positive": 7, "Neutral": 13, "Negative": 192, "Total Reviews": 192, "Responses Positive": 180, "Responses Neutral": 94, "Responses Negative": 100, "Responses Total": 92, "Response Rate Positive": 94, "Response Rate Neutral": 3, "Response Rate Negative": 1, "Response Rate Total": 3 },
            { "Location Title": "Shelby's Shawarma", "Location ID": "Ajax", "Rating": 4.32, "Reviews": 220, "Positive": 12, "Neutral": 36, "Negative": 268, "Total Reviews": 268, "Responses Positive": 34, "Responses Neutral": 11, "Responses Negative": 17, "Responses Total": 22, "Response Rate Positive": 13, "Response Rate Neutral": 3, "Response Rate Negative": 7, "Response Rate Total": 6 },
            { "Location Title": "Shelby's Shawarma", "Location ID": "ErinMills", "Rating": 4.11, "Reviews": 240, "Positive": 17, "Neutral": 60, "Negative": 317, "Total Reviews": 317, "Responses Positive": 113, "Responses Neutral": 36, "Responses Negative": 59, "Responses Total": 28, "Response Rate Positive": 36, "Response Rate Neutral": 2, "Response Rate Negative": 3, "Response Rate Total": 2 },
            { "Location Title": "Shelby's Shawarma", "Location ID": "Kingston", "Rating": 4.62, "Reviews": 244, "Positive": 8, "Neutral": 19, "Negative": 271, "Total Reviews": 271, "Responses Positive": 236, "Responses Neutral": 88, "Responses Negative": 100, "Responses Total": 74, "Response Rate Positive": 87, "Response Rate Neutral": 1, "Response Rate Negative": 2, "Response Rate Total": 1 },
            { "Location Title": "Shelby's Shawarma", "Location ID": "Peterborough", "Rating": 4.62, "Reviews": 190, "Positive": 0, "Neutral": 16, "Negative": 206, "Total Reviews": 206, "Responses Positive": 140, "Responses Neutral": 68, "Responses Negative": 0, "Responses Total": 63, "Response Rate Positive": 68, "Response Rate Neutral": 2, "Response Rate Negative": 0, "Response Rate Total": 2 },
            { "Location Title": "Shelby's Shawarma", "Location ID": "Waterloo", "Rating": 4.12, "Reviews": 268, "Positive": 13, "Neutral": 65, "Negative": 346, "Total Reviews": 346, "Responses Positive": 322, "Responses Neutral": 93, "Responses Negative": 92, "Responses Total": 92, "Response Rate Positive": 93, "Response Rate Neutral": 1, "Response Rate Negative": 0, "Response Rate Total": 0 },
            { "Location Title": "Shelby's Shawarma", "Location ID": "Richmond Hill", "Rating": 4.62, "Reviews": 353, "Positive": 11, "Neutral": 29, "Negative": 393, "Total Reviews": 393, "Responses Positive": 386, "Responses Neutral": 98, "Responses Negative": 100, "Responses Total": 98, "Response Rate Positive": 98, "Response Rate Neutral": 1, "Response Rate Negative": 3, "Response Rate Total": 2 },
            { "Location Title": "Abbas Smoothies", "Location ID": "Richmond St", "Rating": 5, "Reviews": 20, "Positive": 0, "Neutral": 0, "Negative": 20, "Total Reviews": 20, "Responses Positive": 3, "Responses Neutral": 15, "Responses Negative": 0, "Responses Total": 0, "Response Rate Positive": 15, "Response Rate Neutral": 0, "Response Rate Negative": 0, "Response Rate Total": 0 },
            { "Location Title": "Shelby's Shawarma", "Location ID": "Woodbridge", "Rating": 4.7, "Reviews": 292, "Positive": 6, "Neutral": 18, "Negative": 316, "Total Reviews": 316, "Responses Positive": 279, "Responses Neutral": 89, "Responses Negative": 83, "Responses Total": 78, "Response Rate Positive": 88, "Response Rate Neutral": 1, "Response Rate Negative": 2, "Response Rate Total": 2 },
            { "Location Title": "Shelby's Shawarma", "Location ID": "West hill", "Rating": 4.5, "Reviews": 214, "Positive": 10, "Neutral": 20, "Negative": 244, "Total Reviews": 244, "Responses Positive": 226, "Responses Neutral": 92, "Responses Negative": 100, "Responses Total": 95, "Response Rate Positive": 93, "Response Rate Neutral": 1, "Response Rate Negative": 1, "Response Rate Total": 1 },
            { "Location Title": "Shelby's Shawarma", "Location ID": "Dundas Square", "Rating": 4.37, "Reviews": 335, "Positive": 14, "Neutral": 52, "Negative": 401, "Total Reviews": 401, "Responses Positive": 138, "Responses Neutral": 35, "Responses Negative": 7, "Responses Total": 40, "Response Rate Positive": 34, "Response Rate Neutral": 1, "Response Rate Negative": 5, "Response Rate Total": 2 },
            { "Location Title": "Shelby's Shawarma", "Location ID": "Bramalea", "Rating": 4.53, "Reviews": 483, "Positive": 15, "Neutral": 48, "Negative": 546, "Total Reviews": 546, "Responses Positive": 238, "Responses Neutral": 45, "Responses Negative": 33, "Responses Total": 35, "Response Rate Positive": 44, "Response Rate Neutral": 0, "Response Rate Negative": 0, "Response Rate Total": 0 },
            { "Location Title": "Shelby's Shawarma", "Location ID": "Pearson Airport", "Rating": 4.47, "Reviews": 309, "Positive": 14, "Neutral": 37, "Negative": 360, "Total Reviews": 360, "Responses Positive": 166, "Responses Neutral": 50, "Responses Negative": 7, "Responses Total": 27, "Response Rate Positive": 46, "Response Rate Neutral": 1, "Response Rate Negative": 0, "Response Rate Total": 1 },
            { "Location Title": "Shelby's Shawarma", "Location ID": "Nepean", "Rating": 4.71, "Reviews": 913, "Positive": 17, "Neutral": 59, "Negative": 989, "Total Reviews": 989, "Responses Positive": 434, "Responses Neutral": 47, "Responses Negative": 6, "Responses Total": 12, "Response Rate Positive": 44, "Response Rate Neutral": 0, "Response Rate Negative": 0, "Response Rate Total": 1 },
            { "Location Title": "Shelby's Shawarma", "Location ID": "Kanata", "Rating": 4.46, "Reviews": 515, "Positive": 9, "Neutral": 72, "Negative": 596, "Total Reviews": 596, "Responses Positive": 283, "Responses Neutral": 47, "Responses Negative": 22, "Responses Total": 54, "Response Rate Positive": 47, "Response Rate Neutral": 0, "Response Rate Negative": 6, "Response Rate Total": 1 },
            { "Location Title": "Shelby's Shawarma", "Location ID": "Sudbury", "Rating": 0, "Reviews": 0, "Positive": 0, "Neutral": 0, "Negative": 0, "Total Reviews": 0, "Responses Positive": 0, "Responses Neutral": 0, "Responses Negative": 0, "Responses Total": 0, "Response Rate Positive": 0, "Response Rate Neutral": 0, "Response Rate Negative": 0, "Response Rate Total": 0 },
            { "Location Title": "Shelby's Shawarma", "Location ID": "Kitchener", "Rating": 4.83, "Reviews": 181, "Positive": 2, "Neutral": 6, "Negative": 189, "Total Reviews": 189, "Responses Positive": 147, "Responses Neutral": 78, "Responses Negative": 100, "Responses Total": 67, "Response Rate Positive": 78, "Response Rate Neutral": 6, "Response Rate Negative": 6, "Response Rate Total": 6 },
            { "Location Title": "Shelby's Shawarma", "Location ID": "Newmarket", "Rating": 4.71, "Reviews": 228, "Positive": 1, "Neutral": 17, "Negative": 246, "Total Reviews": 246, "Responses Positive": 237, "Responses Neutral": 96, "Responses Negative": 100, "Responses Total": 94, "Response Rate Positive": 96, "Response Rate Neutral": 3, "Response Rate Negative": 1, "Response Rate Total": 3 },
            { "Location Title": "Shelby's Shawarma", "Location ID": "Guelph", "Rating": 0, "Reviews": 0, "Positive": 0, "Neutral": 0, "Negative": 0, "Total Reviews": 0, "Responses Positive": 0, "Responses Neutral": 0, "Responses Negative": 0, "Responses Total": 0, "Response Rate Positive": 0, "Response Rate Neutral": 0, "Response Rate Negative": 0, "Response Rate Total": 0 } // Added Guelph
        ];

        // New, corrected response time data provided by the user
        const updatedResponseMetrics = {
            "Downtown": { "Response Rate Total": 26, "Response Time Total": 1 },
            "Oakville": { "Response Rate Total": 35, "Response Time Total": 2 },
            "Upper James": { "Response Rate Total": 25, "Response Time Total": 3 },
            "White Oaks": { "Response Rate Total": 37, "Response Time Total": 2 },
            "Talbot Village": { "Response Rate Total": 42, "Response Time Total": 1 },
            "MasonVille": { "Response Rate Total": 19, "Response Time Total": 2 },
            "Highbury": { "Response Rate Total": 22, "Response Time Total": 0 },
            "Oakridge": { "Response Rate Total": 18, "Response Time Total": 3 },
            "West Five": { "Response Rate Total": 30, "Response Time Total": 1 },
            "St Thomas": { "Response Rate Total": 40, "Response Time Total": 1 },
            "Strathroy": { "Response Rate Total": 0, "Response Time Total": 0 },
            "Hespeler": { "Response Rate Total": 45, "Response Time Total": 0 },
            "Windsor": { "Response Rate Total": 31, "Response Time Total": 0 },
            "Rexdale": { "Response Rate Total": 39, "Response Time Total": 2 },
            "Queen & Spadina": { "Response Rate Total": 39, "Response Time Total": 1 },
            "Bloor & Bathurst": { "Response Rate Total": 30, "Response Time Total": 2 },
            "Bloor West Village": { "Response Rate Total": 10, "Response Time Total": 2 },
            "Montpelier": { "Response Rate Total": 35, "Response Time Total": 1 },
            "Hwy #7": { "Response Rate Total": 36, "Response Time Total": 1 },
            "St.Catharines": { "Response Rate Total": 56, "Response Time Total": 1 },
            "McLeod": { "Response Rate Total": 74, "Response Time Total": 1 },
            "Clearbrook": { "Response Rate Total": 36, "Response Time Total": 1 },
            "Sarnia": { "Response Rate Total": 33, "Response Time Total": 2 },
            "Burlington": { "Response Rate Total": 26, "Response Time Total": 1 },
            "Head Office": { "Response Rate Total": 0, "Response Time Total": 0 },
            "Lawrence": { "Response Rate Total": 84, "Response Time Total": 2 },
            "King & John": { "Response Rate Total": 24, "Response Time Total": 1 },
            "McMaster": { "Response Rate Total": 94, "Response Time Total": 3 },
            "Ajax": { "Response Rate Total": 13, "Response Time Total": 4 },
            "ErinMills": { "Response Rate Total": 36, "Response Time Total": 2 },
            "Kingston": { "Response Rate Total": 87, "Response Time Total": 1 },
            "Peterborough": { "Response Rate Total": 68, "Response Time Total": 2 },
            "Waterloo": { "Response Rate Total": 93, "Response Time Total": 0 },
            "Richmond Hill": { "Response Rate Total": 98, "Response Time Total": 1 },
            "Richmond St": { "Response Rate Total": 15, "Response Time Total": 0 }, // Matched to "Location ID" for Abbas Smoothies
            "Woodbridge": { "Response Rate Total": 88, "Response Time Total": 1 },
            "West hill": { "Response Rate Total": 93, "Response Time Total": 1 },
            "Dundas Square": { "Response Rate Total": 34, "Response Time Total": 1 },
            "Bramalea": { "Response Rate Total": 44, "Response Time Total": 0 },
            "Pearson Airport": { "Response Rate Total": 46, "Response Time Total": 1 },
            "Nepean": { "Response Rate Total": 44, "Response Time Total": 0 },
            "Kanata": { "Response Rate Total": 47, "Response Time Total": 0 },
            "Sudbury": { "Response Rate Total": 0, "Response Time Total": 0 },
            "Kitchener": { "Response Rate Total": 78, "Response Time Total": 6 },
            "Newmarket": { "Response Rate Total": 96, "Response Time Total": 3 },
            "Guelph": { "Response Rate Total": 0, "Response Time Total": 0 }
        };


        // Function to apply the new response times and rates
        function applyNewResponseMetrics() {
            responseRateData.forEach(location => {
                const locationId = location["Location ID"];
                const lookupKey = (location["Location Title"] === "Abbas Smoothies" && locationId === "Richmond St") ? "Richmond St" : locationId;

                if (updatedResponseMetrics.hasOwnProperty(lookupKey)) {
                    const metrics = updatedResponseMetrics[lookupKey];
                    location["Response Rate Total"] = metrics["Response Rate Total"];
                    location["Response Time Total"] = metrics["Response Time Total"];
                }
            });

            // Add Guelph if it doesn't exist (ensure it's handled if not already in the main data array)
            const guelphExists = responseRateData.some(loc => loc["Location ID"] === "Guelph");
            if (!guelphExists && updatedResponseMetrics.hasOwnProperty("Guelph")) {
                const metrics = updatedResponseMetrics["Guelph"];
                responseRateData.push({
                    "Location Title": "Shelby's Shawarma", // Assuming default title
                    "Location ID": "Guelph",
                    "Rating": 0, "Reviews": 0, "Positive": 0, "Neutral": 0, "Negative": 0, "Total Reviews": 0,
                    "Responses Positive": 0, "Responses Neutral": 0, "Responses Negative": 0, "Responses Total": 0,
                    "Response Rate Positive": 0, "Response Rate Neutral": 0, "Response Rate Negative": 0, // These can be calculated or set to 0
                    "Response Rate Total": metrics["Response Rate Total"],
                    "Response Time Positive": 0, "Response Time Neutral": 0, "Response Time Negative": 0,
                    "Response Time Total": metrics["Response Time Total"]
                });
            }
        }


        // Function to populate Response Rate Table
        function populateResponseRateTable() {
            const tableBody = document.querySelector('#responseRateTable tbody');
            tableBody.innerHTML = ''; // Clear existing rows

            responseRateData.forEach(location => {
                const row = tableBody.insertRow();
                // Using the provided "Total Reviews" from the data as the base for overall rate
                const totalReviews = location["Total Reviews"]; 
                
                // Using the provided "Total Responses" from the data
                const totalResponses = location["Responses Total"]; // Now using the "Responses Total" from the original data structure

                // Calculate actual response rates for positive and negative based on provided data
                const positiveReviewCount = location["Positive"]; 
                const negativeReviewCount = location["Negative"]; 

                // Ensure no division by zero for sentiment-specific response rates
                const positiveResponseRate = positiveReviewCount > 0 ? ((location["Responses Positive"] / positiveReviewCount) * 100).toFixed(1) : 0;
                const negativeResponseRate = negativeReviewCount > 0 ? ((location["Responses Negative"] / negativeReviewCount) * 100).toFixed(1) : 0;
                
                // Use the directly provided total response rate
                const totalResponseRate = location["Response Rate Total"];


                row.insertCell().textContent = location["Location ID"];
                row.insertCell().textContent = location["Rating"];
                row.insertCell().textContent = totalReviews; 
                row.insertCell().textContent = totalResponses; 
                row.insertCell().textContent = `${totalResponseRate}%`; // Use the directly provided total response rate
                row.insertCell().textContent = location["Response Time Total"]; // Use the directly provided total response time
                row.insertCell().textContent = `${positiveResponseRate}%`;
                row.insertCell().textContent = `${negativeResponseRate}%`;

                // Add color coding for response rates
                row.cells[4].classList.add(totalResponseRate >= 80 ? 'sentiment-positive' : (totalResponseRate >= 50 ? 'sentiment-neutral' : 'sentiment-negative'));
                row.cells[6].classList.add(positiveResponseRate >= 80 ? 'sentiment-positive' : (positiveResponseRate >= 50 ? 'sentiment-neutral' : 'sentiment-negative'));
                row.cells[7].classList.add(negativeResponseRate >= 80 ? 'sentiment-positive' : (negativeResponseRate >= 50 ? 'sentiment-neutral' : 'sentiment-negative'));

                // Add color coding for response time (lower is better)
                if (location["Response Time Total"] <= 1) {
                    row.cells[5].classList.add('sentiment-positive');
                } else if (location["Response Time Total"] <= 3) {
                    row.cells[5].classList.add('sentiment-neutral');
                } else {
                    row.cells[5].classList.add('sentiment-negative');
                }
            });
        }

        // Function to populate Trend Chart Table
        function populateTrendChartTable() {
            const tableBody = document.querySelector('#trendChartTable tbody');
            tableBody.innerHTML = ''; // Clear existing rows

            trendChartData.forEach(trend => {
                const row = tableBody.insertCell();
                row.insertCell().textContent = trend.Name;
                for (const key in trend) {
                    if (key !== "Name") {
                        const cell = row.insertCell();
                        cell.textContent = trend[key];
                        // Apply color coding based on sentiment index
                        if (trend[key] >= 50) {
                            cell.classList.add('sentiment-positive');
                        } else if (trend[key] >= 0) { // Neutral or slightly positive
                            cell.classList.add('sentiment-neutral');
                        } else { // Negative
                            cell.classList.add('sentiment-negative');
                        }
                    }
                }
            });
        }

        // Initial population on page load
        window.onload = () => {
            applyNewResponseMetrics(); // Apply the new response times and rates first
            populateResponseRateTable();
            populateTrendChartTable();
        };
    </script>
</body>
</html>
